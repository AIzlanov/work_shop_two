# ü©∫ ML Prediction Service ‚Äî –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
## –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑—É–µ—Ç:
- –º–æ–¥–µ–ª—å –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –ø–æ –¥–∞–Ω–Ω—ã–º –∏–∑ –¥–∞—Ç–∞—Å–µ—Ç–∞;
- –º–æ–¥—É–ª—å–Ω—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É –¥–ª—è –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞;
- FastAPI-—Å–µ—Ä–≤–∏—Å –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ;
- –≥–µ–Ω–µ—Ä–∞—Ü–∏—é CSV-—Ñ–∞–π–ª–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π (id, prediction);
- —Å–∫—Ä–∏–ø—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–π –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è–º–∏.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
Workshop-1/  
‚îÇ  
‚îú‚îÄ‚îÄ model/  
‚îÇ   ‚îú‚îÄ‚îÄ data_processor.py  
‚îÇ   ‚îú‚îÄ‚îÄ model_loader.py  
‚îÇ   ‚îú‚îÄ‚îÄ predictor.py  
‚îÇ   ‚îú‚îÄ‚îÄ model_wrapper.py  
‚îÇ  
‚îú‚îÄ‚îÄ data/  
‚îÇ   ‚îî‚îÄ‚îÄ heart_test.csv  
‚îÇ   ‚îî‚îÄ‚îÄ heart_train.csv  
‚îÇ  
‚îú‚îÄ‚îÄ predictions/  
‚îÇ   ‚îî‚îÄ‚îÄ ... (–≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è)  
‚îÇ  
‚îú‚îÄ‚îÄ app.py  
‚îú‚îÄ‚îÄ best_model.pkl  
‚îú‚îÄ‚îÄ best_threshold.json  
‚îú‚îÄ‚îÄ requirements.txt (—Å–≤–µ–¥–µ–Ω–∏—è –æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ö)  
‚îú‚îÄ‚îÄ test.py (—Ñ–∞–π–ª –ø—Ä–µ–¥–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–π –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏)  
‚îú‚îÄ‚îÄ research.ipynb (—Ç–µ—Ç—Ä–∞–¥–∫–∞ —Å –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ–º)  
‚îî‚îÄ‚îÄ README.md  

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞
1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞  
```bash
git clone https://github.com/AIzlanov/work_shop_one.git
```    

3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```bash
pip install -r requirements.txt
```

5. –ó–∞–ø—É—Å–∫ FastAPI-—Å–µ—Ä–≤–∏—Å–∞  
–ø–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –ø–∞–ø–∫—É —Å –º–æ–¥–µ–ª—å—é, –Ω–∞–ø—Ä–∏–º–µ—Ä, —É –º–µ–Ω—è —ç—Ç–æ:
```bash
cd C:\GitProjects\work_shop_one
``` 
–∑–∞—Ç–µ–º –∑–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:  
```bash
uvicorn app:app --reload
```

–ó–∞—Ç–µ–º:   
- –û—Ç–∫—Ä—ã—Ç—å 
```html
http://127.0.0.1:8000/docs
```  
- –ù–∞–π—Ç–∏ –º–µ—Ç–æ–¥ POST `/predict_upload`
- –ù–∞–∂–∞—Ç—å –Ω–∞ `Try it out`
- –ù–∞–∂–∞—Ç—å –Ω–∞ `Choose File`
- –í—ã–±—Ä–∞—Ç—å —Ñ–∞–π–ª (heart_test.csv –∏–ª–∏ –ø–æ–¥–æ–±–Ω—ã–π)
- –ù–∞–∂–∞—Ç—å `Execute`   
- –ü–æ–ª—É—á–∏—Ç—å JSON –≤–∏–¥–∞:  
```json
{
  "out_path": "predictions/predictions_upload_20251119T125400.csv",
  "n_rows": 935
}
```
- –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–∞–π–ª –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –ª–µ–∂–∏—Ç –≤ –ø–∞–ø–∫–µ /predictions

### –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —á–µ—Ä–µ–∑ API  
–≠–Ω–¥–ø–æ–∏–Ω—Ç: /predict_upload  
–ú–µ—Ç–æ–¥: POST  
–¢–∏–ø: –∑–∞–≥—Ä—É–∑–∫–∞ CSV —Ñ–∞–π–ª–∞  
–û—Ç–≤–µ—Ç: JSON + —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–π CSV —Å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è–º–∏  

### –§–æ—Ä–º–∞—Ç –≤—Ö–æ–¥–Ω–æ–≥–æ CSV:
–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∫–æ–ª–æ–Ω–∫—É `id` –∏ –≤—Å–µ –≤—Ö–æ–¥–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –º–æ–¥–µ–ª–∏.

### –§–æ—Ä–º–∞—Ç –≤—ã—Ö–æ–¥–Ω–æ–≥–æ CSV
–°–æ–¥–µ—Ä–∂–∏—Ç –¥–≤–µ –∫–æ–ª–æ–Ω–∫–∏: `id` –∏ `prediction`.

–ü—Ä–∏–º–µ—Ä:
```
id,prediction
12,1
13,0
14,1
...
```

## –û–ø–∏—Å–∞–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
### DataProcessor
–û—Ç–≤–µ—á–∞–µ—Ç –∑–∞:
- –æ—á–∏—Å—Ç–∫—É –∏ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö;
- –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤;
- –æ–±—Ä–∞–±–æ—Ç–∫—É –ø—Ä–æ–ø—É—Å–∫–æ–≤;
- –ø–æ–¥–≥–æ—Ç–æ–≤–∫—É –¥–∞–Ω–Ω—ã—Ö –≤ —Ç–∞–∫–æ–º –∂–µ –≤–∏–¥–µ, –∫–∞–∫ –≤ –Ω–æ—É—Ç–±—É–∫–µ –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏ –º–æ–¥–µ–ª–∏.

–ú–µ—Ç–æ–¥—ã:
- fit(df) ‚Äî –≤—ã—á–∏—Å–ª—è–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π
- transform(df) ‚Äî –ø—Ä–∏–º–µ–Ω—è–µ—Ç –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è

### ModelLoader
–û—Ç–≤–µ—á–∞–µ—Ç –∑–∞:
- –∑–∞–≥—Ä—É–∑–∫—É —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–æ–π ML-–º–æ–¥–µ–ª–∏ (best_model.pkl);
- –∑–∞–≥—Ä—É–∑–∫—É –ø–æ—Ä–æ–≥–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ (best_threshold.json);
- —Ä–∞–±–æ—Ç—É –º–µ—Ç–æ–¥–∞ predict_proba.

### Predictor
- –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –æ—Ç –º–æ–¥–µ–ª–∏
- —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç —Å –ø–æ—Ä–æ–≥–æ–º
- –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –±–∏–Ω–∞—Ä–Ω—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
  
–ú–µ—Ç–æ–¥—ã:
- predict(X) ‚Üí –º–∞—Å—Å–∏–≤ 0/1

### ModelWrapper
–ò–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç –≤—Å—ë –≤–º–µ—Å—Ç–µ:
- –∑–∞–≥—Ä—É–∂–∞–µ—Ç –º–æ–¥–µ–ª—å –∏ –ø–æ—Ä–æ–≥
- —Å–æ–∑–¥–∞—ë—Ç DataProcessor
- –æ–±—É—á–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –Ω–∞ train-–¥–∞–Ω–Ω—ã—Ö
- –≤—ã–ø–æ–ª–Ω—è–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è

–ú–µ—Ç–æ–¥—ã:
- predict_from_df(df):
    - —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ
    - –∏–∑–≤–ª–µ–∫–∞–µ—Ç id
    - –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç
    - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç (ids, preds)

## –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å–∞
- –ü—Ä–∏–Ω–∏–º–∞–µ—Ç CSV
- –í—ã–ø–æ–ª–Ω—è–µ—Ç –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫—É –¥–∞–Ω–Ω—ã—Ö
- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –º–æ–¥–µ–ª–∏
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç JSON + —Å–æ–∑–¥–∞—ë—Ç –∏—Ç–æ–≥–æ–≤—ã–π CSV
- –°–æ–≤–º–µ—Å—Ç–∏–º–æ —Å–æ —Å–∫—Ä–∏–ø—Ç–æ–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–π

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ
–í —Ä–∞–º–∫–∞—Ö —ç—Ç–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ –±—ã–ª–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —Å–ª–µ–¥—É—é—â–∏–π —à–∞–≥–∏:
- —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–∞ –º–æ–¥–µ–ª—å
- –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞
- —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–∞ FastAPI
- –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –≤ CSV-—Ñ–æ—Ä–º–∞—Ç–µ
- –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –Ω–∞–ø–∏—Å–∞–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
